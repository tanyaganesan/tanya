%**************************************************************************
% Determines beam element matrix
%**************************************************************************
function [keb1,keb2,keb3] = beam_sitff(le,Eb,Ib,t2,k2)
%**************************************************************************
keb1(1,1) = Gaussinf(@(x)36/le^4*x^2);
keb1(1,2) = Gaussinf(@(x)6/le^3*x*(3*x-1));
keb1(1,3) = Gaussinf(@(x)-36/le^4*x^2);
keb1(1,4) = Gaussinf(@(x)6/le^3*x*(3*x+1));
%**************
keb1(2,2) = Gaussinf(@(x)1/le^2*(3*x-1)^2);
keb1(2,3) = Gaussinf(@(x)-6/le^3*x*(3*x-1));
keb1(2,4) = Gaussinf(@(x)1/le^2*(9*x^2-1));
%**************
keb1(3,3) = Gaussinf(@(x)36/le^4*x^2);
keb1(3,4) = Gaussinf(@(x)-6/le^3*x*(3*x+1));
%**************
keb1(4,4) = Gaussinf(@(x)1/le^2*(3*x+1)^2);
%**************
keb1(2,1) = keb1(1,2);
keb1(3,1) = keb1(1,3);
keb1(3,2) = keb1(2,3);
keb1(4,1) = keb1(1,4);
keb1(4,2) = keb1(2,4);
keb1(4,3) = keb1(3,4);
%**************************************************************************
keb1 = Eb * Ib* le/2 * keb1;
%**************************************************************************
keb2(1,1) = Gaussinf(@(x)9/(4*le^2)*(x^2-1)^2);
keb2(1,2) = Gaussinf(@(x)3/(8*le)*(3*x^2-2*x-1)*(x^2-1));
keb2(1,3) = Gaussinf(@(x)9/(4*le^2)*(x^2-1)*(1-x^2));
keb2(1,4) = Gaussinf(@(x)3/(8*le)*(x^2-1)*(3*x^2+2*x-1));
%**************
keb2(2,2) = Gaussinf(@(x)1/16*(3*x^2-2*x-1)^2);
keb2(2,3) = Gaussinf(@(x)3/(8*le)*(1-x^2)*(3*x^2-2*x-1));
keb2(2,4) = Gaussinf(@(x)1/16*(3*x^2-2*x-1)*(3*x^2+2*x-1));
%**************
keb2(3,3) = Gaussinf(@(x)9/(4*le^2)*(1-x^2)^2);
keb2(3,4) = Gaussinf(@(x)3/(8*le)*(1-x^2)*(3*x^2+2*x-1));
%**************
keb2(4,4) = Gaussinf(@(x)1/16*(3*x^2+2*x-1)^2);
%**************
keb2(2,1) = keb2(1,2);
keb2(3,1) = keb2(1,3);
keb2(3,2) = keb2(2,3);
keb2(4,1) = keb2(1,4);
keb2(4,2) = keb2(2,4);
keb2(4,3) = keb2(3,4);
%**************************************************************************
keb2 = 2 * t2 * le/2 * keb2;
%**************************************************************************
keb3(1,1) = Gaussinf(@(x)1/16*(1-x)^4*(2+x)^2);
keb3(1,2) = Gaussinf(@(x)le/32*(1-x)^4*(1+x)*(2+x));
keb3(1,3) = Gaussinf(@(x)1/16*(1-x)^2*(1+x)^2*(2-x)*(2+x));
keb3(1,4) = Gaussinf(@(x)-le/32*(1-x)^2*(1+x)^2*(2+x)*(1-x));
%**************
keb3(2,2) = Gaussinf(@(x)le^2/64*(1-x)^4*(1+x)^2);
keb3(2,3) = Gaussinf(@(x)le/32*(1-x)^2*(1+x)^2*(1+x)*(2-x));
keb3(2,4) = Gaussinf(@(x)-le^2/64*(1-x)^2*(1+x)^2*(1-x^2));
%**************
keb3(3,3) = Gaussinf(@(x)1/16*(1+x)^4*(2-x)^2);
keb3(3,4) = Gaussinf(@(x)-le/32*(1+x)^4*(2-x)*(1-x));
%**************
keb3(4,4) = Gaussinf(@(x)le^2/64*(1+x)^4*(1-x)^2);
%**************
keb3(2,1) = keb3(1,2);
keb3(3,1) = keb3(1,3);
keb3(3,2) = keb3(2,3);
keb3(4,1) = keb3(1,4);
keb3(4,2) = keb3(2,4);
keb3(4,3) = keb3(3,4);
%**************************************************************************
keb3 = k2 * le/2 * keb3;
%**************************************************************************
return