%**************************************************************************
% Determines Shape Function of beam element & soil element
%**************************************************************************
function [Nb,d2Nb,d3Nb,Ns] = shape_fn(le,x)
%**************************************************************************
% Shape function for beam
Nb1 = (1/4)*(1-x)^2*(2+x);
Nb2 = (le/8)*(1-x)^2*(1+x);
Nb3 = (1/4)*(1+x)^2*(2-x);
Nb4 = -(le/8)*(1+x)^2*(1-x);
Nb = [Nb1 Nb2 Nb3 Nb4];
% *********
d2Nb1 = 6*x/le^2;
d2Nb2 = (3*x-1)/le;
d2Nb3 = -6*x/le^2;
d2Nb4 = (3*x+1)/le;
d2Nb = [d2Nb1 d2Nb2 d2Nb3 d2Nb4];
% *********
d3Nb1 = 12/le^3;
d3Nb2 = 6/le^2;
d3Nb3 = -12/le^3;
d3Nb4 = 6/le^2;
d3Nb = [d3Nb1 d3Nb2 d3Nb3 d3Nb4];
%**************************************************************************
% Shape function for soil
Ns1 = (1-x)/2;
Ns2 = (1+x)/2;
Ns = [Ns1 Ns2];
%**************************************************************************
return